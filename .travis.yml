dist: bionic
language: go
sudo: false

matrix:
  include:
    # "1.x" always refers to the latest Go version, inc. the patch release.
    # e.g. "1.x" is 1.11 until 1.11.1 is available.
    - go: 1.x
      env: LATEST=true
    - go: 1.12.x
    - go: 1.13.x
    - go: master
  allow_failures:
    - go: master

before_install:
  - make bootstrap

install:
  - make dep

before_script:
  - make vet
  - make check_spelling

script:
  - go test -race -coverprofile=coverage.txt -covermode=atomic ./...
  - if [ "${LATEST}" = "true" ]; then make; else make local; fi

after_success:
  - bash <(curl -s https://codecov.io/bash)


